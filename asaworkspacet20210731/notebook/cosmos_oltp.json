{
	"name": "cosmos_oltp",
	"properties": {
		"nbformat": 4,
		"nbformat_minor": 2,
		"bigDataPool": {
			"referenceName": "SparkPool02",
			"type": "BigDataPoolReference"
		},
		"sessionProperties": {
			"driverMemory": "56g",
			"driverCores": 8,
			"executorMemory": "56g",
			"executorCores": 8,
			"numExecutors": 2,
			"runAsWorkspaceSystemIdentity": false,
			"conf": {
				"spark.dynamicAllocation.enabled": "false",
				"spark.dynamicAllocation.minExecutors": "2",
				"spark.dynamicAllocation.maxExecutors": "2",
				"spark.autotune.trackingId": "a23fb698-df30-414e-8370-b37cd907e1f5"
			}
		},
		"metadata": {
			"saveOutput": true,
			"synapse_widget": {
				"version": "0.1",
				"state": {
					"ad7a00aa-9153-42b7-b4a6-710d763d013e": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "2",
										"1": "0.232864734",
										"2": "0.248934934",
										"3": "10.55320518",
										"4": "0.463887065",
										"5": "0.103953406",
										"6": "0.114279949",
										"7": "0.303585347",
										"8": "2.110122129",
										"9": "1.142857143",
										"10": "1.927279669",
										"11": "0.376926613",
										"12": "337296e3-33ab-4f3b-9246-b721d03c329f"
									},
									{
										"0": "5",
										"1": "0.117368032",
										"2": "0.32122573",
										"3": "10.92237097",
										"4": "0.535883355",
										"5": "0.103091585",
										"6": "0.053875277",
										"7": "0.410568032",
										"8": "3.801997814",
										"9": "0.681818182",
										"10": "1.600573425",
										"11": "0.736306837",
										"12": "9d4ea353-22c3-42da-a224-0c1657bab1d1"
									},
									{
										"0": "8",
										"1": "0.252394035",
										"2": "0.095173274",
										"3": "10.59700966",
										"4": "0.054227156",
										"5": "0.131749698",
										"6": "0.035243328",
										"7": "0.283074736",
										"8": "2.636332801",
										"9": "1.5",
										"10": "2.905384316",
										"11": "0.641015947",
										"12": "60fe94a4-65a8-44bb-bb52-6918b4383b7d"
									},
									{
										"0": "9",
										"1": "0.269119018",
										"2": "0.222172318",
										"3": "10.78715178",
										"4": "0.505747126",
										"5": "0.096830474",
										"6": "0.032618826",
										"7": "0.358994501",
										"8": "1.103278736",
										"9": "0.666666667",
										"10": "1.820474337",
										"11": "0.441268272",
										"12": "4471f60b-8e61-4a34-a5da-100a291a664e"
									},
									{
										"0": "12",
										"1": "0.178341405",
										"2": "0.253412969",
										"3": "9.996659083",
										"4": "0.386627907",
										"5": "0.057212416",
										"6": "0.380697988",
										"7": "0.390941597",
										"8": "9.198733552",
										"9": "1.111111111",
										"10": "0.83930322",
										"11": "0.10599881",
										"12": "a95cd606-a21d-4a28-b981-066e1e1a0dba"
									},
									{
										"0": "14",
										"1": "0.213949275",
										"2": "0.348293024",
										"3": "11.04392933",
										"4": "0.750769908",
										"5": "0.107894294",
										"6": "0.034178744",
										"7": "0.362305746",
										"8": "3.320947571",
										"9": "0.75",
										"10": "2.359891293",
										"11": "0.73181003",
										"12": "17238b0a-12dc-48a0-8881-84287e907f2b"
									},
									{
										"0": "18",
										"1": "0.272313368",
										"2": "0.072246456",
										"3": "10.39197554",
										"4": "0.093351946",
										"5": "0.097937631",
										"6": "0.074417144",
										"7": "0.313907719",
										"8": "1.980307092",
										"9": "0.666666667",
										"10": "1.684315129",
										"11": "0.154224764",
										"12": "ded23fff-9414-4430-84a1-65ca7f0bfe6b"
									},
									{
										"0": "21",
										"1": "0.066896458",
										"2": "0.17750345",
										"3": "10.71619397",
										"4": "0.123485737",
										"5": "0.164179104",
										"6": "0.105038777",
										"7": "0.406070931",
										"8": "0.267524672",
										"9": "1.05",
										"10": "1.953944431",
										"11": "0.602073176",
										"12": "964b5913-4f78-44e5-a386-93c680a94803"
									},
									{
										"0": "28",
										"1": "0.213308785",
										"2": "0.233162564",
										"3": "10.79853422",
										"4": "0.445140033",
										"5": "0.103665655",
										"6": "0.055935473",
										"7": "0.389058524",
										"8": "2.912922287",
										"9": "1.727272727",
										"10": "1.820776686",
										"11": "0.814221001",
										"12": "bcafb9fe-36d7-4137-969e-5fc6961c2243"
									},
									{
										"0": "32",
										"1": "0.254953032",
										"2": "0.198259861",
										"3": "10.67447502",
										"4": "0.538346427",
										"5": "0.080251365",
										"6": "0.031938514",
										"7": "0.344152081",
										"8": "6.497971979",
										"9": "0.52173913",
										"10": "3.337253941",
										"11": "0.365659802",
										"12": "2f74b526-0082-4884-a353-5a681bae9c28"
									},
									{
										"0": "33",
										"1": "0.134169965",
										"2": "0.419688004",
										"3": "10.34592726",
										"4": "0.862559242",
										"5": "0.013506356",
										"6": "0.130127179",
										"7": "0.472308288",
										"8": "3.129556199",
										"9": "2.416666667",
										"10": "0.867215261",
										"11": "0.752824617",
										"12": "7018b504-99a4-440e-89f1-091d6b1192c5"
									},
									{
										"0": "40",
										"1": "0.1818518",
										"2": "0.072128605",
										"3": "10.55025042",
										"4": "0.068989386",
										"5": "0.126812989",
										"6": "0.044053067",
										"7": "0.306107955",
										"8": "1.086386161",
										"9": "0.4",
										"10": "1.28992007",
										"11": "0.444661211",
										"12": "6f36dfbe-7a0b-4d47-b0e3-d0729660036c"
									},
									{
										"0": "44",
										"1": "0.190982776",
										"2": "0.329738388",
										"3": "10.86915875",
										"4": "0.64268521",
										"5": "0.116388096",
										"6": "0.037632074",
										"7": "0.340794382",
										"8": "6.134798707",
										"9": "0.615384615",
										"10": "1.64310311",
										"11": "0.539190205",
										"12": "253574b4-f4c4-447e-aa6f-1a717ae1f398"
									},
									{
										"0": "45",
										"1": "0.128857348",
										"2": "0.280150164",
										"3": "10.74537796",
										"4": "0.342017119",
										"5": "0.083717204",
										"6": "0.087233873",
										"7": "0.464112624",
										"8": "3.158816596",
										"9": "1.25",
										"10": "2.891890631",
										"11": "0.887524737",
										"12": "f8f19d9d-0b2b-4b9d-92f5-5a06fc690c30"
									},
									{
										"0": "47",
										"1": "0.125798297",
										"2": "0.140598651",
										"3": "10.63532646",
										"4": "0.335671343",
										"5": "0.145731588",
										"6": "0.120675891",
										"7": "0.398027021",
										"8": "4.910910687",
										"9": "2.028571429",
										"10": "1.967744964",
										"11": "0.794855358",
										"12": "a75a9f51-f8bb-435e-a791-2bec82429e84"
									},
									{
										"0": "48",
										"1": "0.097921961",
										"2": "0.303260384",
										"3": "10.75602879",
										"4": "0.303356282",
										"5": "0.07848683",
										"6": "0.099491703",
										"7": "0.459682823",
										"8": "4.65068687",
										"9": "1.615384615",
										"10": "2.198071182",
										"11": "0.904416734",
										"12": "a441d936-9cfc-4131-b54e-f1f3f384062c"
									},
									{
										"0": "49",
										"1": "0.187473187",
										"2": "0.319949969",
										"3": "10.80675383",
										"4": "0.431708991",
										"5": "0.10247191",
										"6": "0.038352638",
										"7": "0.346411721",
										"8": "3.439418592",
										"9": "2.272727273",
										"10": "1.807235771",
										"11": "0.920568958",
										"12": "6c3a763e-04ac-45c5-bf76-d1fc83da257a"
									},
									{
										"0": "50",
										"1": "0.153357376",
										"2": "0.128764278",
										"3": "10.58930796",
										"4": "0.240180587",
										"5": "0.111798396",
										"6": "0.07092564",
										"7": "0.3242127",
										"8": "2.767046304",
										"9": "0.727272727",
										"10": "1.939328534",
										"11": "0.470972765",
										"12": "4a6c1574-8045-49a4-ac27-7afa22895b8e"
									},
									{
										"0": "51",
										"1": "0.176159718",
										"2": "0.171916711",
										"3": "10.62083942",
										"4": "0.316889001",
										"5": "0.130340815",
										"6": "0.025425719",
										"7": "0.313189796",
										"8": "2.102553804",
										"9": "1.25",
										"10": "2.226766425",
										"11": "0.310202569",
										"12": "084c4262-ab7e-46d3-ab15-fade954f35b0"
									},
									{
										"0": "52",
										"1": "0.152241195",
										"2": "0.372927296",
										"3": "11.05101698",
										"4": "0.727728684",
										"5": "0.101976511",
										"6": "0.084898613",
										"7": "0.393476864",
										"8": "4.793439152",
										"9": "1.055555556",
										"10": "2.533671515",
										"11": "0.334511569",
										"12": "93a1af24-2141-488d-a7ed-e3396a4de734"
									},
									{
										"0": "53",
										"1": "0.300278681",
										"2": "0.2703835",
										"3": "10.60000405",
										"4": "0.441323063",
										"5": "0.113686757",
										"6": "0.065722248",
										"7": "0.312635693",
										"8": "10.45970992",
										"9": "1.0",
										"10": "2.132004658",
										"11": "0.332950694",
										"12": "7cfa6576-ac1f-4d74-8988-7ba12252cd6d"
									},
									{
										"0": "54",
										"1": "0.090222278",
										"2": "0.421125644",
										"3": "10.91089788",
										"4": "0.646023263",
										"5": "0.103522408",
										"6": "0.046640859",
										"7": "0.43671875",
										"8": "4.899564267",
										"9": "1.333333333",
										"10": "1.963412365",
										"11": "0.645830051",
										"12": "1be08fc7-d203-423a-ac0e-473a8e85a513"
									},
									{
										"0": "56",
										"1": "0.192888549",
										"2": "0.237550719",
										"3": "10.83182543",
										"4": "0.578125",
										"5": "0.105927922",
										"6": "0.041356019",
										"7": "0.362168183",
										"8": "4.865720568",
										"9": "0.533333333",
										"10": "2.998578338",
										"11": "0.496126662",
										"12": "e426c031-6cfa-4c0b-98de-e4bfc415e0ac"
									},
									{
										"0": "59",
										"1": "0.110818913",
										"2": "0.233036093",
										"3": "10.7150398",
										"4": "0.292651757",
										"5": "0.140676118",
										"6": "0.024246568",
										"7": "0.390696107",
										"8": "0.217274596",
										"9": "1.0",
										"10": "3.331154049",
										"11": "0.395539036",
										"12": "0d1efbe8-3287-4641-b7bc-b386a8f06928"
									},
									{
										"0": "62",
										"1": "0.222534262",
										"2": "0.517760337",
										"3": "11.23619652",
										"4": "0.916699488",
										"5": "0.103979265",
										"6": "0.026510896",
										"7": "0.322765158",
										"8": "5.452685258",
										"9": "0.705882353",
										"10": "2.184049779",
										"11": "0.201722445",
										"12": "2028761d-1419-4e2a-962b-1f6225afbfe9"
									},
									{
										"0": "64",
										"1": "0.141992021",
										"2": "0.16082131",
										"3": "10.60581744",
										"4": "0.093860685",
										"5": "0.135339885",
										"6": "0.070034198",
										"7": "0.391294542",
										"8": "3.503787688",
										"9": "1.923076923",
										"10": "1.939224403",
										"11": "0.560240328",
										"12": "40825b54-f452-4726-95d9-dba1ddcf10c8"
									},
									{
										"0": "67",
										"1": "0.210272984",
										"2": "0.284394654",
										"3": "10.79695991",
										"4": "0.376326075",
										"5": "0.101871469",
										"6": "0.050539779",
										"7": "0.385157627",
										"8": "1.63276453",
										"9": "1.785714286",
										"10": "1.929939975",
										"11": "1.143366607",
										"12": "ef181d61-8c2e-41b3-b6e8-9507db8b8993"
									},
									{
										"0": "68",
										"1": "0.181417756",
										"2": "0.159721511",
										"3": "10.1883657",
										"4": "0.218654434",
										"5": "0.108476376",
										"6": "0.220991053",
										"7": "0.330539657",
										"8": "6.650601624",
										"9": "1.538461538",
										"10": "1.626191859",
										"11": "0.125092069",
										"12": "05386e26-8af2-457b-baf5-76defab55052"
									},
									{
										"0": "70",
										"1": "0.190235804",
										"2": "0.165669605",
										"3": "10.41235125",
										"4": "0.049271137",
										"5": "0.110542664",
										"6": "0.162860821",
										"7": "0.32772939",
										"8": "3.909329477",
										"9": "0.5",
										"10": "3.527768437",
										"11": "0.367773151",
										"12": "f9272e1d-6ab3-4637-a3b7-f80e304aeca7"
									},
									{
										"0": "71",
										"1": "0.26807087",
										"2": "0.159588077",
										"3": "10.40483843",
										"4": "0.163882428",
										"5": "0.075013729",
										"6": "0.074828009",
										"7": "0.303101737",
										"8": "6.673879403",
										"9": "1.45",
										"10": "1.818358986",
										"11": "0.266474174",
										"12": "cae76cee-705d-4f4b-98c6-4cf9c0bc15a3"
									},
									{
										"0": "72",
										"1": "0.283727688",
										"2": "0.268724553",
										"3": "10.71219307",
										"4": "0.571315163",
										"5": "0.101522843",
										"6": "0.04593884",
										"7": "0.331130976",
										"8": "3.002118069",
										"9": "0.857142857",
										"10": "1.696152707",
										"11": "0.644907796",
										"12": "a0ea73af-775c-4000-ae9d-05c2bfc9766a"
									},
									{
										"0": "73",
										"1": "0.257450782",
										"2": "0.07305396",
										"3": "10.61496569",
										"4": "0.005144033",
										"5": "0.135340763",
										"6": "0.109213291",
										"7": "0.292748225",
										"8": "2.584605038",
										"9": "1.5",
										"10": "3.228630183",
										"11": "0.18318752",
										"12": "6e696204-edd6-4896-8214-abaa4a65f58d"
									},
									{
										"0": "74",
										"1": "0.307397856",
										"2": "0.07119776",
										"3": "10.48001664",
										"4": "0.15625",
										"5": "0.090196478",
										"6": "0.041542429",
										"7": "0.297796572",
										"8": "7.05964577",
										"9": "0.666666667",
										"10": "2.533639879",
										"11": "0.394653498",
										"12": "63a4e1c7-badd-4ae1-ab7c-39ced523e205"
									},
									{
										"0": "75",
										"1": "0.207699493",
										"2": "0.219548453",
										"3": "9.867082871",
										"4": "0.496",
										"5": "0.063964709",
										"6": "0.415999466",
										"7": "0.315583259",
										"8": "7.192666501",
										"9": "2.230769231",
										"10": "1.375126442",
										"11": "0.703181889",
										"12": "2cfd0876-33e8-4a6f-a7ee-3cccf8fb26d2"
									},
									{
										"0": "76",
										"1": "0.149192423",
										"2": "0.087711787",
										"3": "10.1406129",
										"4": "0.096330275",
										"5": "0.144373905",
										"6": "0.425324028",
										"7": "0.296352584",
										"8": "3.558380317",
										"9": "0.909090909",
										"10": "1.07563146",
										"11": "0.214416531",
										"12": "61407522-bcee-4c5f-9e2d-8d5c0217c8e9"
									},
									{
										"0": "77",
										"1": "0.10110045",
										"2": "0.376871097",
										"3": "10.98312087",
										"4": "0.624113475",
										"5": "0.118093174",
										"6": "0.073507887",
										"7": "0.414163823",
										"8": "1.875487675",
										"9": "1.176470588",
										"10": "2.510313339",
										"11": "0.554352329",
										"12": "8824d066-7977-40ed-9aee-8aee135bd3b4"
									},
									{
										"0": "78",
										"1": "0.111947994",
										"2": "0.314432275",
										"3": "10.95917494",
										"4": "0.528312901",
										"5": "0.111221204",
										"6": "0.056086079",
										"7": "0.423952262",
										"8": "0.132096821",
										"9": "1.142857143",
										"10": "1.704244878",
										"11": "0.515669276",
										"12": "a4b861ba-2894-463f-a3bc-eb4df2350aec"
									},
									{
										"0": "80",
										"1": "0.152691263",
										"2": "0.304465687",
										"3": "10.90950929",
										"4": "0.548122392",
										"5": "0.099890045",
										"6": "0.041910238",
										"7": "0.403603604",
										"8": "0.323594391",
										"9": "0.5",
										"10": "1.755245053",
										"11": "0.356535884",
										"12": "c5a113d4-51c5-4e2a-b486-d9c8f482e6b3"
									},
									{
										"0": "81",
										"1": "0.181118938",
										"2": "0.234201612",
										"3": "10.71993585",
										"4": "0.478846154",
										"5": "0.088337065",
										"6": "0.073961623",
										"7": "0.42954279",
										"8": "3.768907476",
										"9": "0.791666667",
										"10": "1.132215571",
										"11": "0.379390304",
										"12": "14cbe9a8-799d-49e9-b6c1-a0cbc061abf5"
									},
									{
										"0": "83",
										"1": "0.200834686",
										"2": "0.145984905",
										"3": "10.45607873",
										"4": "0.050756901",
										"5": "0.098153547",
										"6": "0.107628101",
										"7": "0.330632306",
										"8": "1.346800846",
										"9": "1.6",
										"10": "3.901358126",
										"11": "0.261860719",
										"12": "61de26bd-3f26-4512-be6c-7d8ce6882022"
									},
									{
										"0": "84",
										"1": "0.122100005",
										"2": "0.188094318",
										"3": "10.76561773",
										"4": "0.491441083",
										"5": "0.161592506",
										"6": "0.02963639",
										"7": "0.346358237",
										"8": "0.966161669",
										"9": "1.684210526",
										"10": "1.582358998",
										"11": "0.618634025",
										"12": "1ef92637-faf6-43c6-83d7-ef5e45b7338e"
									},
									{
										"0": "86",
										"1": "0.138756374",
										"2": "0.096763919",
										"3": "10.08897077",
										"4": "0.21005386",
										"5": "0.118656482",
										"6": "0.427866425",
										"7": "0.293206793",
										"8": "2.038235325",
										"9": "0.952380952",
										"10": "1.165745204",
										"11": "0.460779411",
										"12": "f1b1bfb1-eec7-4be4-ab7e-4b06bcd9e856"
									},
									{
										"0": "88",
										"1": "0.160414212",
										"2": "0.15163275",
										"3": "10.54980515",
										"4": "0.18957346",
										"5": "0.13516767",
										"6": "0.142928009",
										"7": "0.401899961",
										"8": "4.981954638",
										"9": "1.6",
										"10": "2.087538672",
										"11": "0.489796498",
										"12": "9f71ea52-f4da-41d8-a1b6-7559e8c12db5"
									},
									{
										"0": "89",
										"1": "0.205811359",
										"2": "0.053349435",
										"3": "10.30811898",
										"4": "0.00250941",
										"5": "0.158335448",
										"6": "0.353053696",
										"7": "0.297890415",
										"8": "7.139074251",
										"9": "1.526315789",
										"10": "1.734594238",
										"11": "0.232061895",
										"12": "9e08928c-4005-4c18-9827-13ee8dd3bc26"
									},
									{
										"0": "90",
										"1": "0.225219573",
										"2": "0.050193454",
										"3": "10.5046565",
										"4": "0.005700872",
										"5": "0.124328331",
										"6": "0.268367489",
										"7": "0.244462674",
										"8": "12.84014961",
										"9": "2.461538462",
										"10": "4.107901798",
										"11": "0.370342571",
										"12": "48382e7d-e3c8-4483-8441-35bd6b5006ec"
									},
									{
										"0": "91",
										"1": "0.255730611",
										"2": "0.144310113",
										"3": "10.53844932",
										"4": "0.144424674",
										"5": "0.108284634",
										"6": "0.024680506",
										"7": "0.289097744",
										"8": "6.292594104",
										"9": "2.571428571",
										"10": "2.089837391",
										"11": "0.681790161",
										"12": "d8e16edf-2f14-46df-98bf-0b7a8f2c0bc5"
									},
									{
										"0": "92",
										"1": "0.137827632",
										"2": "0.27012665",
										"3": "10.65780038",
										"4": "0.134417808",
										"5": "0.15049505",
										"6": "0.375388716",
										"7": "0.323033209",
										"8": "3.764544229",
										"9": "2.25",
										"10": "1.591835871",
										"11": "0.348654011",
										"12": "e24d15f7-08c3-42ce-89a9-9c475a7ad1d0"
									},
									{
										"0": "93",
										"1": "0.142390194",
										"2": "0.363016383",
										"3": "10.36719012",
										"4": "0.491839763",
										"5": "0.072001002",
										"6": "0.347395301",
										"7": "0.420637376",
										"8": "13.1902194",
										"9": "0.666666667",
										"10": "1.331641281",
										"11": "0.222243272",
										"12": "691ef664-9464-45b9-a80e-8fd70b3dab1c"
									},
									{
										"0": "94",
										"1": "0.103002197",
										"2": "0.229390404",
										"3": "10.7445158",
										"4": "0.367446809",
										"5": "0.128111377",
										"6": "0.059311691",
										"7": "0.402313223",
										"8": "3.960019335",
										"9": "1.494736842",
										"10": "1.804932958",
										"11": "0.42732801",
										"12": "b51130d9-8be9-4484-9151-bb63044ca0b0"
									},
									{
										"0": "95",
										"1": "0.230717504",
										"2": "0.085642082",
										"3": "10.38347245",
										"4": "0.042876284",
										"5": "0.105074321",
										"6": "0.096900007",
										"7": "0.292846213",
										"8": "8.551712371",
										"9": "1.428571429",
										"10": "2.007203953",
										"11": "0.489206218",
										"12": "fe249a6d-13d1-4c12-b259-698ea024d884"
									},
									{
										"0": "97",
										"1": "0.142433234",
										"2": "0.178182783",
										"3": "10.48374595",
										"4": "0.135732648",
										"5": "0.139324117",
										"6": "0.233612085",
										"7": "0.390218878",
										"8": "16.73439396",
										"9": "1.1875",
										"10": "2.520728232",
										"11": "0.271672959",
										"12": "fcd66493-0d24-4504-8084-1ea6c5997b42"
									},
									{
										"0": "98",
										"1": "0.24920053",
										"2": "0.051702821",
										"3": "10.57359638",
										"4": "0.009843473",
										"5": "0.125409403",
										"6": "0.164963731",
										"7": "0.299584392",
										"8": "6.23035712",
										"9": "1.5",
										"10": "3.133176717",
										"11": "0.381569368",
										"12": "eb16bf2a-45e4-4feb-ac3b-e78d5e475189"
									},
									{
										"0": "100",
										"1": "0.136995144",
										"2": "0.049550286",
										"3": "10.0365751",
										"4": "0.011117974",
										"5": "0.216354344",
										"6": "0.564086801",
										"7": "0.267233951",
										"8": "8.369534986",
										"9": "1.115384615",
										"10": "2.109824346",
										"11": "0.197683955",
										"12": "4a8974cb-35e9-4136-a6d3-f4cae2364fc7"
									},
									{
										"0": "101",
										"1": "0.225035218",
										"2": "0.174741859",
										"3": "10.65993812",
										"4": "0.354573672",
										"5": "0.096042271",
										"6": "0.087422017",
										"7": "0.390065147",
										"8": "4.849622717",
										"9": "0.5",
										"10": "2.200317948",
										"11": "0.342081421",
										"12": "a3b6e79a-da21-46d8-9c9e-cf4f20c79cf7"
									},
									{
										"0": "102",
										"1": "0.216626232",
										"2": "0.120657539",
										"3": "10.49385422",
										"4": "0.034301485",
										"5": "0.13893104",
										"6": "0.172158585",
										"7": "0.289944134",
										"8": "5.844058186",
										"9": "0.689655172",
										"10": "2.353846891",
										"11": "0.158903149",
										"12": "177390d9-6492-4653-a18d-84600c1e8c4c"
									},
									{
										"0": "103",
										"1": "0.058053966",
										"2": "0.194621102",
										"3": "10.58524512",
										"4": "0.090007348",
										"5": "0.204916868",
										"6": "0.187760899",
										"7": "0.36129428",
										"8": "5.100649474",
										"9": "1.2",
										"10": "3.300102441",
										"11": "0.421982695",
										"12": "01155baa-6c44-44bc-b657-136be63185e2"
									},
									{
										"0": "104",
										"1": "0.135286373",
										"2": "0.249684461",
										"3": "10.69885282",
										"4": "0.407496492",
										"5": "0.117514274",
										"6": "0.039405624",
										"7": "0.405306896",
										"8": "11.94482409",
										"9": "1.052631579",
										"10": "1.342004856",
										"11": "0.189129482",
										"12": "52ecae97-aa37-48b9-977d-d6ee09900d2c"
									},
									{
										"0": "105",
										"1": "0.175542126",
										"2": "0.094235589",
										"3": "10.41439317",
										"4": "0.074418605",
										"5": "0.159839527",
										"6": "0.365410594",
										"7": "0.360890119",
										"8": "4.037829402",
										"9": "0.96",
										"10": "3.354376593",
										"11": "0.520134391",
										"12": "e9ea1b79-e27d-41ea-82a4-3cfb084866e6"
									},
									{
										"0": "106",
										"1": "0.109887349",
										"2": "0.157939308",
										"3": "10.50684678",
										"4": "0.099963249",
										"5": "0.146638759",
										"6": "0.19058587",
										"7": "0.367482993",
										"8": "6.250902694",
										"9": "0.904761905",
										"10": "0.991094709",
										"11": "0.103491755",
										"12": "08be506b-510d-4549-9060-618035019ffb"
									},
									{
										"0": "107",
										"1": "0.261867453",
										"2": "0.273051907",
										"3": "10.82713119",
										"4": "0.533949633",
										"5": "0.094316953",
										"6": "0.025624482",
										"7": "0.311220523",
										"8": "5.821370205",
										"9": "1.19047619",
										"10": "1.994644862",
										"11": "0.300364461",
										"12": "ebaefe43-5d51-427e-9d0f-6ad2ebb541fd"
									},
									{
										"0": "109",
										"1": "0.151055656",
										"2": "0.476916693",
										"3": "11.23319833",
										"4": "0.878804348",
										"5": "0.114171257",
										"6": "0.060687451",
										"7": "0.340806694",
										"8": "7.481499805",
										"9": "0.714285714",
										"10": "2.416943478",
										"11": "0.394100191",
										"12": "92c9ac02-8ae1-4b68-abb5-98329f07a509"
									},
									{
										"0": "110",
										"1": "0.114956688",
										"2": "0.167553191",
										"3": "10.52085999",
										"4": "0.232741256",
										"5": "0.161950632",
										"6": "0.152944449",
										"7": "0.404314087",
										"8": "8.458996675",
										"9": "0.954545455",
										"10": "2.335458124",
										"11": "0.321927182",
										"12": "33fcb039-095f-4bc1-873a-a61c12871783"
									},
									{
										"0": "111",
										"1": "0.210512842",
										"2": "0.096928919",
										"3": "10.13828296",
										"4": "0.012746711",
										"5": "0.157135934",
										"6": "0.995690759",
										"7": "0.288515406",
										"8": "12.19094513",
										"9": "1.894736842",
										"10": "1.465672465",
										"11": "0.289203431",
										"12": "ee0b143b-a859-401a-a09c-5834d1f019f4"
									},
									{
										"0": "112",
										"1": "0.08972372",
										"2": "0.329898517",
										"3": "10.88265918",
										"4": "0.56065207",
										"5": "0.096660967",
										"6": "0.069710243",
										"7": "0.440164355",
										"8": "3.101112587",
										"9": "0.535714286",
										"10": "3.017842945",
										"11": "0.311666297",
										"12": "296a798c-d354-4d6a-b238-a17f92a2d10b"
									},
									{
										"0": "113",
										"1": "0.299352545",
										"2": "0.151592429",
										"3": "10.64766049",
										"4": "0.378173027",
										"5": "0.091559829",
										"6": "0.026448309",
										"7": "0.297514876",
										"8": "4.235048902",
										"9": "0.52173913",
										"10": "3.305794933",
										"11": "0.366915963",
										"12": "62b2bc17-6384-4c29-9e9a-945ac5c155ff"
									},
									{
										"0": "114",
										"1": "0.182173295",
										"2": "0.094424515",
										"3": "10.34794899",
										"4": "0.009842116",
										"5": "0.111967075",
										"6": "0.441169508",
										"7": "0.307476963",
										"8": "4.935835625",
										"9": "1.454545455",
										"10": "3.239227061",
										"11": "0.147758687",
										"12": "9d2b4596-6b1d-4d65-aba8-b2a54eb4e782"
									},
									{
										"0": "115",
										"1": "0.060280055",
										"2": "0.406312482",
										"3": "10.94748525",
										"4": "0.64424253",
										"5": "0.151332196",
										"6": "0.043971995",
										"7": "0.405279954",
										"8": "4.837982618",
										"9": "0.952380952",
										"10": "1.717685861",
										"11": "0.350483258",
										"12": "4029721b-792f-4a53-8bfc-aab2995d7d75"
									},
									{
										"0": "116",
										"1": "0.18817339",
										"2": "0.259224748",
										"3": "10.69711335",
										"4": "0.308160505",
										"5": "0.117657192",
										"6": "0.033137058",
										"7": "0.35563513",
										"8": "3.215079635",
										"9": "1.666666667",
										"10": "1.55776418",
										"11": "0.812883335",
										"12": "2c910b36-2098-4dbd-a8d0-6218b1e36fba"
									},
									{
										"0": "117",
										"1": "0.110102729",
										"2": "0.249083542",
										"3": "10.76096203",
										"4": "0.352834113",
										"5": "0.106357795",
										"6": "0.049851894",
										"7": "0.439136251",
										"8": "3.434272274",
										"9": "1.4",
										"10": "1.849425028",
										"11": "0.498380462",
										"12": "cd931ef8-7c7f-49c5-be35-13177c902e5c"
									},
									{
										"0": "118",
										"1": "0.289442379",
										"2": "0.224725883",
										"3": "10.63236378",
										"4": "0.475752773",
										"5": "0.090132827",
										"6": "0.040669145",
										"7": "0.354977468",
										"8": "1.945508831",
										"9": "0.923076923",
										"10": "2.046488588",
										"11": "0.513721734",
										"12": "382391c7-6ec7-4c0a-b66e-0abc17c267bc"
									},
									{
										"0": "119",
										"1": "0.121574965",
										"2": "0.279952033",
										"3": "10.75271926",
										"4": "0.459405941",
										"5": "0.089350352",
										"6": "0.049584956",
										"7": "0.462266179",
										"8": "2.213790697",
										"9": "1.153846154",
										"10": "2.71959438",
										"11": "0.722367357",
										"12": "99820725-fa34-47ff-8ed5-21c0e75a1ad5"
									},
									{
										"0": "121",
										"1": "0.16358133",
										"2": "0.35061287",
										"3": "10.94992897",
										"4": "0.61086249",
										"5": "0.091693756",
										"6": "0.039173539",
										"7": "0.382304265",
										"8": "3.751225161",
										"9": "1.090909091",
										"10": "2.069345766",
										"11": "0.559533568",
										"12": "2209acae-2366-4946-924e-a3eb21b2116b"
									},
									{
										"0": "122",
										"1": "0.061953911",
										"2": "0.255889066",
										"3": "10.77505285",
										"4": "0.280446271",
										"5": "0.125831821",
										"6": "0.078372885",
										"7": "0.425860127",
										"8": "2.597516352",
										"9": "0.6",
										"10": "2.752490308",
										"11": "0.238737607",
										"12": "489a764c-747a-48a5-bacc-91415bfad9ea"
									},
									{
										"0": "123",
										"1": "0.176040942",
										"2": "0.153191489",
										"3": "10.33410045",
										"4": "0.228675136",
										"5": "0.145040289",
										"6": "0.204809699",
										"7": "0.3115727",
										"8": "7.449993976",
										"9": "1.111111111",
										"10": "1.60714281",
										"11": "0.166802611",
										"12": "c1a1ef29-a4f0-4f55-ba92-cfe4a33b0a03"
									},
									{
										"0": "124",
										"1": "0.119625811",
										"2": "0.261875835",
										"3": "10.25895677",
										"4": "0.416315588",
										"5": "0.12494986",
										"6": "0.572355861",
										"7": "0.348518562",
										"8": "6.328746874",
										"9": "0.727272727",
										"10": "1.793795763",
										"11": "0.202168946",
										"12": "81d3033a-0e74-4937-b8dc-6d770bd5910c"
									},
									{
										"0": "126",
										"1": "0.107002273",
										"2": "0.413222417",
										"3": "10.9808762",
										"4": "0.573626374",
										"5": "0.113699475",
										"6": "0.045018573",
										"7": "0.421959283",
										"8": "5.065200839",
										"9": "1.69047619",
										"10": "1.858260236",
										"11": "0.717799295",
										"12": "b6608317-7923-4bd8-8169-675d2ce4f6f5"
									},
									{
										"0": "128",
										"1": "0.157485189",
										"2": "0.211896894",
										"3": "10.15342882",
										"4": "0.26618705",
										"5": "0.100043497",
										"6": "0.355911221",
										"7": "0.398251192",
										"8": "10.6674474",
										"9": "2.0",
										"10": "1.409463486",
										"11": "0.259004207",
										"12": "026e9baf-4830-44ac-a255-0068cbbea1d3"
									},
									{
										"0": "129",
										"1": "0.103412869",
										"2": "0.307842548",
										"3": "10.99986401",
										"4": "0.691439828",
										"5": "0.122080527",
										"6": "0.034128692",
										"7": "0.367876448",
										"8": "7.082314817",
										"9": "1.041666667",
										"10": "2.65687913",
										"11": "0.342210744",
										"12": "ef3a8e26-cbe6-4cf3-8c98-80e13cc10186"
									},
									{
										"0": "130",
										"1": "0.145117314",
										"2": "0.143406846",
										"3": "9.966650127",
										"4": "0.080565371",
										"5": "0.111081513",
										"6": "0.984896319",
										"7": "0.337029744",
										"8": "17.85595081",
										"9": "1.636363636",
										"10": "0.951815576",
										"11": "0.094561751",
										"12": "8fed1371-d412-4fdb-b1e2-a74265f0809f"
									},
									{
										"0": "131",
										"1": "0.17065481",
										"2": "0.2713958",
										"3": "10.79353697",
										"4": "0.455995496",
										"5": "0.090100341",
										"6": "0.074656427",
										"7": "0.414841412",
										"8": "3.159728192",
										"9": "0.625",
										"10": "1.49003586",
										"11": "0.383226786",
										"12": "1e8faded-0c28-4cf3-8448-087357574cb1"
									},
									{
										"0": "132",
										"1": "0.139617348",
										"2": "0.264528441",
										"3": "10.61915425",
										"4": "0.148870968",
										"5": "0.129984231",
										"6": "0.273974204",
										"7": "0.352754754",
										"8": "2.312046161",
										"9": "1.5625",
										"10": "2.795615017",
										"11": "0.478339596",
										"12": "d9795525-8689-4737-8f3d-debeabac47a6"
									},
									{
										"0": "134",
										"1": "0.090152653",
										"2": "0.247949139",
										"3": "10.7225182",
										"4": "0.346153846",
										"5": "0.154877575",
										"6": "0.105855856",
										"7": "0.388116308",
										"8": "6.678129633",
										"9": "1.972222222",
										"10": "3.224540507",
										"11": "0.657090005",
										"12": "0b6c62b1-8984-4068-93c2-1424c7bd3ae0"
									},
									{
										"0": "137",
										"1": "0.20960245",
										"2": "0.528362014",
										"3": "10.96648993",
										"4": "0.86073903",
										"5": "0.092996052",
										"6": "0.11324985",
										"7": "0.330292847",
										"8": "6.02648362",
										"9": "0.705882353",
										"10": "0.772529732",
										"11": "0.333761209",
										"12": "690334af-8360-458e-9b65-930975a9c779"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "storeId",
										"type": "int"
									},
									{
										"key": "1",
										"name": "ratioAge60",
										"type": "double"
									},
									{
										"key": "2",
										"name": "collegeRatio",
										"type": "double"
									},
									{
										"key": "3",
										"name": "income",
										"type": "double"
									},
									{
										"key": "4",
										"name": "highIncome150Ratio",
										"type": "double"
									},
									{
										"key": "5",
										"name": "largeHH",
										"type": "double"
									},
									{
										"key": "6",
										"name": "minoritiesRatio",
										"type": "double"
									},
									{
										"key": "7",
										"name": "more1FullTimeEmployeeRatio",
										"type": "double"
									},
									{
										"key": "8",
										"name": "distanceNearestWarehouse",
										"type": "double"
									},
									{
										"key": "9",
										"name": "salesNearestWarehousesRatio",
										"type": "double"
									},
									{
										"key": "10",
										"name": "avgDistanceNearest5Supermarkets",
										"type": "double"
									},
									{
										"key": "11",
										"name": "salesNearest5StoresRatio",
										"type": "double"
									},
									{
										"key": "12",
										"name": "id",
										"type": "string"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					}
				}
			},
			"enableDebugMode": false,
			"kernelspec": {
				"name": "synapse_pyspark",
				"display_name": "Synapse PySpark"
			},
			"language_info": {
				"name": "python"
			},
			"a365ComputeOptions": {
				"id": "/subscriptions/fbf033a1-3ebb-4140-bb7f-b406cf96c1b7/resourceGroups/data-engineering-synapse/providers/Microsoft.Synapse/workspaces/asaworkspacet20210731/bigDataPools/SparkPool02",
				"name": "SparkPool02",
				"type": "Spark",
				"endpoint": "https://asaworkspacet20210731.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool02",
				"auth": {
					"type": "AAD",
					"authResource": "https://dev.azuresynapse.net",
					"authHeader": null
				},
				"sparkVersion": "3.1",
				"nodeCount": 10,
				"cores": 8,
				"memory": 56,
				"extraHeader": null
			},
			"sessionKeepAliveTimeout": 30
		},
		"cells": [
			{
				"cell_type": "code",
				"source": [
					"dfStoreDemoGraphics = (spark\r\n",
					"                .read\r\n",
					"                .csv(\"abfss://cosmosdb@asadatalaket20210731.dfs.core.windows.net/StoreDemoGraphics.csv\", header=True, inferSchema='true')\r\n",
					"              )\r\n",
					"\r\n",
					"dfRetailSales = (spark\r\n",
					"                .read\r\n",
					"                .csv(\"abfss://cosmosdb@asadatalaket20210731.dfs.core.windows.net/RetailSales.csv\", header=True, inferSchema='true')\r\n",
					"              )\r\n",
					"\r\n",
					"dfProduct = (spark\r\n",
					"                .read\r\n",
					"                .csv(\"abfss://cosmosdb@asadatalaket20210731.dfs.core.windows.net/Products.csv\", header=True, inferSchema='true')\r\n",
					"              )"
				],
				"execution_count": 2
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# To select a preferred list of regions in a multi-region Azure Cosmos DB account, add .option(\"spark.cosmos.preferredRegions\", \"<Region1>,<Region2>\")\r\n",
					"\r\n",
					"df = spark.read.format(\"cosmos.olap\")\\\r\n",
					"    .option(\"spark.synapse.linkedService\", \"CosmosDbMongoDbApi1\")\\\r\n",
					"    .option(\"spark.cosmos.container\", \"StoreDemoGraphics\")\\\r\n",
					"    .load()"
				],
				"execution_count": 4
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"display(dfStoreDemoGraphics)"
				],
				"execution_count": 2
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"dfStoreDemoGraphics.write.format(\"cosmos.oltp\")\\\r\n",
					"    .option(\"spark.synapse.linkedService\", \"CosmosDbMongoDbApi1\")\\\r\n",
					"    .option(\"spark.cosmos.container\", \"StoreDemoGraphics\")\\\r\n",
					"    .mode('append')\\\r\n",
					"    .save()"
				],
				"execution_count": 5
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"dfRetailSales.write\\\r\n",
					"            .format(\"cosmos.oltp\")\\\r\n",
					"            .option(\"spark.synapse.linkedService\", \"asacosmosdb01\")\\\r\n",
					"            .option(\"spark.cosmos.container\", \"RetailSales\")\\\r\n",
					"            .mode('append')\\\r\n",
					"            .save()\r\n",
					"\r\n",
					"dfProduct.write\\\r\n",
					"            .format(\"cosmos.oltp\")\\\r\n",
					"            .option(\"spark.synapse.linkedService\", \"asacosmosdb01\")\\\r\n",
					"            .option(\"spark.cosmos.container\", \"Products\")\\\r\n",
					"            .mode('append')\\\r\n",
					"            .save()"
				],
				"execution_count": 5
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"dfStream = (spark\r\n",
					"                .readStream\r\n",
					"                .format(\"rate\")\r\n",
					"                .option(\"rowsPerSecond\", 10)\r\n",
					"                .load()\r\n",
					"            )"
				]
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"import pyspark.sql.functions as F\r\n",
					"from pyspark.sql.types import StringType\r\n",
					"import uuid\r\n",
					"\r\n",
					"numberOfDevices = 10\r\n",
					"generate_uuid = F.udf(lambda : str(uuid.uuid4()), StringType())\r\n",
					"              \r\n",
					"dfIoTSignals = (dfStream\r\n",
					"                    .withColumn(\"id\", generate_uuid())\r\n",
					"                    .withColumn(\"deviceId\", F.concat(F.lit(\"dev-\"), F.expr(\"mod(value, %d)\" % numberOfDevices)))\r\n",
					"                    .withColumn(\"dateTime\", dfStream[\"timestamp\"].cast(StringType()))\r\n",
					"                    .withColumn(\"unit\", F.expr(\"CASE WHEN rand() < 0.5 THEN 'Revolutions per Minute' ELSE 'MegaWatts' END\"))\r\n",
					"                    .withColumn(\"unitSymbol\", F.expr(\"CASE WHEN rand() < 0.5 THEN 'RPM' ELSE 'MW' END\"))\r\n",
					"                    .withColumn(\"measureType\", F.expr(\"CASE WHEN rand() < 0.5 THEN 'Rotation Speed' ELSE 'Output' END\"))\r\n",
					"                    .withColumn(\"measureValue\", F.expr(\"CASE WHEN rand() > 0.95 THEN value * 10 WHEN rand() < 0.05 THEN value div 10 ELSE value END\"))\r\n",
					"                    .drop(\"timestamp\", \"value\")\r\n",
					"                )"
				],
				"execution_count": 1
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"streamQuery = dfIoTSignals\\\r\n",
					"                    .writeStream\\\r\n",
					"                    .format(\"cosmos.oltp\")\\\r\n",
					"                    .outputMode(\"append\")\\\r\n",
					"                    .option(\"spark.cosmos.connection.mode\", \"gateway\") \\\r\n",
					"                    .option(\"spark.synapse.linkedService\", \"CosmosDBIoTDemo\")\\\r\n",
					"                    .option(\"spark.cosmos.container\", \"IoTSignals\")\\\r\n",
					"                    .option(\"checkpointLocation\", \"/writeCheckpointDir\")\\\r\n",
					"                    .start()\r\n",
					"\r\n",
					"streamQuery.awaitTermination()"
				]
			}
		]
	}
}