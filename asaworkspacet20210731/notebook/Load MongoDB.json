{
	"name": "Load MongoDB",
	"properties": {
		"nbformat": 4,
		"nbformat_minor": 2,
		"bigDataPool": {
			"referenceName": "SparkPool02",
			"type": "BigDataPoolReference"
		},
		"sessionProperties": {
			"driverMemory": "56g",
			"driverCores": 8,
			"executorMemory": "56g",
			"executorCores": 8,
			"numExecutors": 2,
			"runAsWorkspaceSystemIdentity": false,
			"conf": {
				"spark.dynamicAllocation.enabled": "false",
				"spark.dynamicAllocation.minExecutors": "2",
				"spark.dynamicAllocation.maxExecutors": "2",
				"spark.autotune.trackingId": "645f82aa-bfe0-4880-93ed-20fe4178183a",
				"spark.synapse.library.python.env": "zope.interface 5.4.0\r\nzope.event 4.5.0\r\nzipp 3.5.0\r\nyarl 1.6.3\r\nxgboost 1.4.0\r\nwrapt 1.12.1\r\nwidgetsnbextension 3.5.2\r\nwheel 0.36.2\r\nWerkzeug 2.0.1\r\nwebsocket-client 1.1.0\r\nwebencodings 0.5.1\r\nwcwidth 0.2.5\r\nurllib3 1.26.4\r\ntyping-extensions 3.10.0.0\r\ntyped-ast 1.4.3\r\ntraitlets 5.0.5\r\ntqdm 4.61.2\r\ntornado 6.1\r\ntorchvision 0.9.1\r\ntorch 1.8.1\r\ntoolz 0.11.1\r\ntinycss2 1.1.1\r\ntifffile 2021.4.8\r\nthreadpoolctl 2.1.0\r\ntextblob 0.15.3\r\nterminado 0.13.3\r\ntermcolor 1.1.0\r\ntensorflow 2.4.1\r\ntensorflow-estimator 2.4.0\r\ntensorboard 2.4.1\r\ntensorboard-plugin-wit 1.8.0\r\ntenacity 7.0.0\r\ntabulate 0.8.9\r\nstatsmodels 0.12.2\r\nSQLAlchemy 1.4.20\r\nsoupsieve 2.2.1\r\nsmmap 3.0.5\r\nsmart-open 5.1.0\r\nslicer 0.0.7\r\nsklearn-pandas 2.2.0\r\nskl2onnx 1.8.0\r\nsix 1.16.0\r\nshap 0.39.0\r\nsetuptools 49.6.0.post20210108\r\nSend2Trash 1.8.0\r\nSecretStorage 3.3.1\r\nseaborn 0.11.1\r\nscipy 1.5.3\r\nscikit-learn 0.23.2\r\nscikit-image 0.18.1\r\nSALib 1.3.11\r\nruamel.yaml 0.17.4\r\nruamel.yaml.clib 0.2.6\r\nruamel-yaml-conda 0.15.100\r\nrsa 4.7.2\r\nretrying 1.3.3\r\nrequests 2.25.1\r\nrequests-oauthlib 1.3.0\r\nregex 2021.7.6\r\npyzmq 22.1.0\r\nPyYAML 5.4.1\r\nPyWavelets 1.1.1\r\npyu2f 0.1.5\r\npytz 2021.1\r\npython-dateutil 2.8.1\r\npyspark 3.1.2\r\nPySocks 1.7.1\r\npyrsistent 0.18.1\r\nPyQtWebEngine 5.12.1\r\nPyQtChart 5.12\r\nPyQt5 5.12.3\r\nPyQt5-sip 4.19.18\r\npyperclip 1.8.2\r\npyparsing 2.4.7\r\npyOpenSSL 20.0.1\r\npyodbc 4.0.30\r\nPyJWT 2.1.0\r\nPyGObject 3.40.1\r\nPygments 2.9.0\r\npycparser 2.20\r\npycosat 0.6.3\r\npycairo 1.20.1\r\npyasn1 0.4.8\r\npyasn1-modules 0.2.8\r\npyarrow 3.0.0\r\npy4j 0.10.9\r\nptyprocess 0.7.0\r\npsutil 5.8.0\r\nprotobuf 3.15.8\r\nprompt-toolkit 3.0.19\r\nprometheus-client 0.14.1\r\nprettytable 2.4.0\r\nportalocker 1.7.1\r\npooch 1.4.0\r\npmdarima 1.8.2\r\nplotly 4.14.3\r\npip 21.1.1\r\nPillow 8.2.0\r\npickleshare 0.7.5\r\npexpect 4.8.0\r\npatsy 0.5.1\r\npathspec 0.8.1\r\npartd 1.2.0\r\nparso 0.8.2\r\npandocfilters 1.5.0\r\npandasql 0.7.3\r\npandas 1.2.3\r\npackaging 21.0\r\nopt-einsum 3.3.0\r\nopenpyxl 3.0.7\r\nonnxruntime 1.7.2\r\nonnxmltools 1.7.0\r\nonnxconverter-common 1.7.0\r\nonnx 1.9.0\r\nolefile 0.46\r\noauthlib 3.1.1\r\nnumpy 1.19.4\r\nnumba 0.53.1\r\nnotebookutils 3.1.2-20220415.2\r\nnotebook 6.4.11\r\nnltk 3.6.2\r\nnetworkx 2.5.1\r\nnest-asyncio 1.5.5\r\nndg-httpsclient 0.5.1\r\nnbformat 5.3.0\r\nnbconvert 6.5.0\r\nnbclient 0.6.0\r\nmypy 0.780\r\nmypy-extensions 0.4.3\r\nmultidict 5.1.0\r\nmsrestazure 0.6.4\r\nmsrest 0.6.21\r\nmsal 1.12.0\r\nmsal-extensions 0.3.0\r\nmmlspark-vw 1.0.0.dev1\r\nmmlspark-opencv 1.0.0.dev1\r\nmmlspark-lightgbm 1.0.0.dev1\r\nmmlspark-core 1.0.0.dev1\r\nmmlspark-cognitive 1.0.0.dev1\r\nmlflow-skinny 1.18.0\r\nmleap 0.17.0\r\nmistune 0.8.4\r\nmatplotlib 3.4.2\r\nmatplotlib-inline 0.1.2\r\nMarkupSafe 2.0.1\r\nMarkdown 3.3.4\r\nlxml 4.6.5\r\nllvmlite 0.36.0\r\nlime 0.2.0.1\r\nlightgbm 3.2.1\r\nlibrary-metadata-cooker 0.0.7\r\nliac-arff 2.5.0\r\nKqlmagicCustom 0.1.114.post8\r\nkoalas 1.8.0\r\nkiwisolver 1.3.1\r\nkeras2onnx 1.6.5\r\nKeras-Preprocessing 1.1.2\r\nKeras-Applications 1.0.8\r\njupyterlab-widgets 1.1.0\r\njupyterlab-pygments 0.2.2\r\njupyter-core 4.7.1\r\njupyter-client 6.1.12\r\njsonschema 4.4.0\r\njsonpickle 2.0.0\r\njoblib 1.0.1\r\njmespath 0.10.0\r\nJinja2 3.0.1\r\njeepney 0.6.0\r\njedi 0.18.0\r\njdcal 1.4.1\r\nitsdangerous 2.0.1\r\nisodate 0.6.0\r\nipywidgets 7.6.3\r\nipython 7.23.1\r\nipython-genutils 0.2.0\r\nipykernel 6.0.1\r\nimportlib-resources 5.7.1\r\nimportlib-metadata 4.6.1\r\nimageio 2.9.0\r\nimagecodecs 2021.3.31\r\nidna 2.10\r\nhummingbird-ml 0.4.0\r\nhtml5lib 1.1\r\nh5py 2.10.0\r\ngrpcio 1.37.1\r\ngreenlet 1.1.0\r\ngoogle-pasta 0.2.0\r\ngoogle-auth 1.32.1\r\ngoogle-auth-oauthlib 0.4.1\r\nGitPython 3.1.18\r\ngitdb 4.0.7\r\ngevent 21.1.2\r\ngeopy 2.1.0\r\ngeographiclib 1.52\r\ngensim 3.8.3\r\ngast 0.3.3\r\nfuture 0.18.2\r\nfusepy 3.0.1\r\nfsspec 2021.6.1\r\nfsspec-wrapper 0.1.5\r\nflatbuffers 1.12\r\nFlask 2.0.1\r\nFlask-Compress 0.0.0\r\nfire 0.4.0\r\nfastjsonschema 2.15.3\r\net-xmlfile 1.1.0\r\nentrypoints 0.3\r\ndotnetcore2 2.1.23\r\ndocker 4.4.4\r\ndistro 1.7.0\r\ndill 0.3.4\r\ndefusedxml 0.7.1\r\ndecorator 4.4.2\r\ndebugpy 1.3.0\r\ndatabricks-cli 0.12.1\r\ndask 2021.6.2\r\ndash 1.20.0\r\ndash-table 4.11.3\r\ndash-renderer 1.9.1\r\ndash-html-components 1.1.3\r\ndash-cytoscape 0.2.0\r\ndash-core-components 1.16.0\r\ncytoolz 0.11.0\r\nCython 0.29.23\r\ncycler 0.10.0\r\ncryptography 3.4.7\r\ncontextlib2 0.6.0.post1\r\nconfigparser 5.0.2\r\nconda-package-handling 1.7.3\r\ncloudpickle 1.6.0\r\nclick 8.0.1\r\nchardet 4.0.0\r\ncffi 1.14.5\r\ncertifi 2021.5.30\r\ncachetools 4.2.2\r\nbrotlipy 0.7.0\r\nBrotli 1.0.9\r\nbokeh 2.3.2\r\nblinker 1.4\r\nbleach 5.0.0\r\nbeautifulsoup4 4.9.3\r\nbackports.weakref 1.0.post1\r\nbackports.tempfile 1.0\r\nbackports.functools-lru-cache 1.6.4\r\nbackcall 0.2.0\r\nazureml-telemetry 1.34.0\r\nazureml-synapse 0.0.1\r\nazureml-opendatasets 1.34.0\r\nazureml-mlflow 1.34.0\r\nazureml-dataset-runtime 1.34.0\r\nazureml-dataprep 2.22.2\r\nazureml-dataprep-rslex 1.20.2\r\nazureml-dataprep-native 38.0.0\r\nazureml-core 1.34.0\r\nazure-synapse-ml-predict 1.0.0\r\nazure-storage-blob 12.8.1\r\nazure-mgmt-storage 11.2.0\r\nazure-mgmt-resource 13.0.0\r\nazure-mgmt-keyvault 2.2.0\r\nazure-mgmt-core 1.3.0\r\nazure-mgmt-containerregistry 8.0.0\r\nazure-mgmt-authorization 0.61.0\r\nazure-identity 1.5.0\r\nazure-graphrbac 0.61.1\r\nazure-datalake-store 0.0.51\r\nazure-core 1.22.1\r\nazure-common 1.1.27\r\nattrs 21.2.0\r\nasync-timeout 3.0.1\r\nastunparse 1.6.3\r\nastor 0.8.1\r\nargon2-cffi 21.3.0\r\nargon2-cffi-bindings 21.2.0\r\napplicationinsights 0.11.10\r\nappdirs 1.4.4\r\naiohttp 3.7.4.post0\r\nadlfs 0.7.7\r\nadal 1.2.7\r\nabsl-py 0.13.0\r\nlocket 0.2.1\r\nmongo-spark-connector 3.0.1",
				"spark.synapse.library.python.env.name": "environment.yml"
			}
		},
		"metadata": {
			"saveOutput": true,
			"synapse_widget": {
				"version": "0.1"
			},
			"enableDebugMode": false,
			"kernelspec": {
				"name": "synapse_pyspark",
				"display_name": "Synapse PySpark"
			},
			"language_info": {
				"name": "python"
			},
			"a365ComputeOptions": {
				"id": "/subscriptions/fbf033a1-3ebb-4140-bb7f-b406cf96c1b7/resourceGroups/data-engineering-synapse/providers/Microsoft.Synapse/workspaces/asaworkspacet20210731/bigDataPools/SparkPool02",
				"name": "SparkPool02",
				"type": "Spark",
				"endpoint": "https://asaworkspacet20210731.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool02",
				"auth": {
					"type": "AAD",
					"authResource": "https://dev.azuresynapse.net",
					"authHeader": null
				},
				"sparkVersion": "3.1",
				"nodeCount": 10,
				"cores": 8,
				"memory": 56,
				"extraHeader": null
			},
			"sessionKeepAliveTimeout": 30
		},
		"cells": [
			{
				"cell_type": "code",
				"source": [
					"from pyspark.sql import SparkSession"
				],
				"execution_count": 3
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"sourceConnectionString = \"mongodb://aztgpmcan:bDCdNXag4EGBmPUHgSFcP6hF5ZN9l96YMu21V7f35YDT73hFEuu5btuC9iFayo2ITr8inAspYSKBprPhKzKwWQ==@aztgpmcan.mongo.cosmos.azure.com:10255/?ssl=true&replicaSet=globaldb&retrywrites=false&maxIdleTimeMS=120000&appName=@aztgpmcan@\"\r\n",
					"sourceDb = \"nobel\"\r\n",
					"sourceCollection =  \"laureates\""
				],
				"execution_count": 4
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"my_spark = SparkSession \\\r\n",
					"    .builder \\\r\n",
					"    .appName(\"myApp\") \\\r\n",
					"    .getOrCreate()"
				],
				"execution_count": 5
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"df = my_spark.read.format(\"com.mongodb.spark.sql.DefaultSource\").option(\"uri\", sourceConnectionString).option(\"database\", sourceDb).option(\"collection\", sourceCollection).load()"
				],
				"execution_count": 6
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"df.printSchema()"
				],
				"execution_count": 7
			}
		]
	}
}